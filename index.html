<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Chat do Marquin</title>
</head>
<body>

<h2>Chat Simples</h2>

<input id="nome" placeholder="Seu nome">
<br><br>

<div id="mensagens"></div>

<br>
<input id="mensagem" placeholder="Digite sua mensagem">
<button onclick="enviar()">Enviar</button>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "COLE_AQUI",
  authDomain: "COLE_AQUI",
  projectId: "COLE_AQUI",
  storageBucket: "COLE_AQUI",
  messagingSenderId: "COLE_AQUI",
  appId: "COLE_AQUI"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const mensagensDiv = document.getElementById("mensagens");

onSnapshot(collection(db, "mensagens"), (snapshot) => {
  mensagensDiv.innerHTML = "";
  snapshot.forEach((doc) => {
    const msg = doc.data();
    mensagensDiv.innerHTML += `<p><b>${msg.nome}:</b> ${msg.texto}</p>`;
  });
});

window.enviar = async function() {
  const nome = document.getElementById("nome").value;
  const texto = document.getElementById("mensagem").value;

  await addDoc(collection(db, "mensagens"), {
    nome: nome,
    texto: texto
  });

  document.getElementById("mensagem").value = "";
}

</script>

</body>
</html>